#!/usr/bin/env ruby
# frozen_string_literal: true

require "bundler/setup"
require "wise_gopher"

# You can add fixtures and/or initialization code here to make experimenting
# with your gem easier. You can also use a different console, if you like.

# (If you use this, don't forget to add pry to your Gemfile!)
# require "pry"
# Pry.start

require "irb"

class Object
  private

  def connection
    @connection ||= begin
      ActiveRecord::Base.establish_connection adapter: "sqlite3", database: ":memory:"

      populate_database

      ActiveRecord::Base.connection
    end
  end

  def populate_database
    ActiveRecord::Migration.create_table :posts do |t|
      t.string :title
    end

    ActiveRecord::Base.connection.execute(<<-SQL)
      INSERT INTO posts (title) VALUES ('First Post'), ('Second Post')
    SQL
  end
end

IRB.start(__FILE__)
